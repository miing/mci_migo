YUI.add("one-widget-tooltip",function(e,t){"use strict";var n=e.Lang,r=e.Node,i=-1e4,s=-1e4,o=e.Base.create("tooltip",e.Widget,[e.WidgetPosition,e.WidgetPositionAlign,e.WidgetStack],{initializer:function(){this._triggerClassName=this.getClassName("trigger"),this._currTrigger={node:null,title:null,mouseX:o.OFFSCREEN_X,mouseY:o.OFFSCREEN_Y},this._eventHandles={delegate:null,trigger:{mouseMove:null,mouseOut:null}},this._timers={show:null,hide:null},this.publish("triggerEnter",{defaultFn:this._defTriggerEnterFn,preventable:!0}),this.publish("triggerLeave",{preventable:!1})},destructor:function(){this._clearCurrentTrigger(),this._clearTimers(),this._clearHandles()},bindUI:function(){this.after("compassChange",this._onSetCompass),this.after("delegateChange",this._afterSetDelegate),this.after("nodesChange",this._afterSetNodes),this._bindDelegate()},syncUI:function(){this._uiSetNodes(this.get("triggerNodes")),this.get("boundingBox").addClass(e.ClassNameManager.getClassName("tooltip","position",this.get("compass")))},setTriggerContent:function(t){var i=this.get("contentBox"),s;i.set("innerHTML","");if(t)if(t instanceof r)for(s=0,l=t.size();s<l;++s)i.appendChild(t.item(s));else n.isString(t)&&(this.get("escapeHTML")===!0&&(t=e.Escape.html(t)),i.set("innerHTML",t))},_onSetCompass:function(t){var n=this.get("boundingBox"),r=e.ClassNameManager.getClassName("tooltip","position",t.prevVal),i=e.ClassNameManager.getClassName("tooltip","position",t.newVal);n.replaceClass(r,i)},_afterSetNodes:function(e){this._uiSetNodes(e.newVal)},_afterSetDelegate:function(e){this._bindDelegate(e.newVal)},_uiSetNodes:function(e){this._triggerNodes&&this._triggerNodes.removeClass(this._triggerClassName),e&&(this._triggerNodes=e,this._triggerNodes.addClass(this._triggerClassName))},_bindDelegate:function(){var t=this._eventHandles;t.delegate&&(t.delegate.detach(),t.delegate=null),t.delegate=e.delegate(["mouseenter","focus"],e.bind(this._onNodeEventEnter,this),this.get("delegate"),"."+this._triggerClassName)},_onNodeEventEnter:function(e){var t=e.currentTarget;t&&(!this._currTrigger.node||!t.compareTo(this._currTrigger.node))&&this._enterTrigger(t,e.pageX,e.pageY)},_onNodeMouseLeave:function(e){this._leaveTrigger(e.currentTarget)},_onNodeMouseMove:function(e){this._overTrigger(e.pageX,e.pageY)},_onNodeBlur:function(e){this._leaveTrigger(e.currentTarget)},_enterTrigger:function(e,t,n){this._setCurrentTrigger(e,t,n),this.fire("triggerEnter",{node:e,pageX:t,pageY:n})},_defTriggerEnterFn:function(t){var n=t.node,r;this.get("disabled")||(this._clearTimers(),r=this.get("visible")?0:this.get("showDelay"),this._timers.show=e.later(r,this,this._showTooltip,[n]))},_leaveTrigger:function(){this.fire("triggerLeave"),this._clearCurrentTrigger(),this._clearTimers(),this._timers.hide=e.later(this.get("hideDelay"),this,this._hideTooltip)},_overTrigger:function(e,t){this._currTrigger.mouseX=e,this._currTrigger.mouseY=t},_showTooltip:function(){this.align(this._currTrigger.node,{north:[e.WidgetPositionAlign.BC,e.WidgetPositionAlign.TC],east:[e.WidgetPositionAlign.LC,e.WidgetPositionAlign.RC],south:[e.WidgetPositionAlign.TC,e.WidgetPositionAlign.BC],west:[e.WidgetPositionAlign.RC,e.WidgetPositionAlign.LC]}[this.get("compass")]),this.show(),this._clearTimers(),this._timers.hide=e.later(this.get("autoHideDelay"),this,this._hideTooltip)},_hideTooltip:function(){this._clearTimers(),this.hide()},_setTriggerContent:function(e){var t=this.get("content")||!0;t&&!(t instanceof r||n.isString(t))&&(t=t[e.get("id")]||e.getAttribute("title")),this.setTriggerContent(t)},_setCurrentTrigger:function(t,n,r){var i=this._currTrigger,s=this._eventHandles.trigger,o;this._setTriggerContent(t),s.mouseMove=e.on("mousemove",e.bind(this._onNodeMouseMove,this),t),s.mouseOut=e.on("mouseleave",e.bind(this._onNodeMouseLeave,this),t),s.blur=e.on("blur",e.bind(this._onNodeBlur,this),t),o=t.getAttribute("title"),t.setAttribute("title",""),i.mouseX=n,i.mouseY=r,i.node=t,i.title=o},_clearCurrentTrigger:function(){var e=this._currTrigger,t=this._eventHandles.trigger,n,r;e.node&&(n=e.node,r=e.title||"",e.node=null,e.title="",t.mouseMove.detach(),t.mouseOut.detach(),t.blur.detach(),t.mouseMove=null,t.mouseOut=null,t.blur=null,n.setAttribute("title",r))},_clearTimers:function(){var e=this._timers;e.hide&&(e.hide.cancel(),e.hide=null),e.show&&(e.show.cancel(),e.show=null)},_clearHandles:function(){var e=this._eventHandles;e.delegate&&this._eventHandles.delegate.detach(),e.trigger.mouseOut&&e.trigger.mouseOut.detach(),e.trigger.mouseMove&&e.trigger.mouseMove.detach(),e.trigger.blur&&e.trigger.blur.detach()}},{OFFSET_X:10,OFFSET_Y:5,OFFSCREEN_X:i,OFFSCREEN_Y:s,ATTRS:{content:{value:null},triggerNodes:{value:null,setter:function(e){return e&&n.isString(e)&&(e=r.all(e)),e}},delegate:{value:null,setter:function(t){return e.one(t)||e.one("document")}},showDelay:{value:250},hideDelay:{value:10},autoHideDelay:{value:2e3},visible:{value:!1},xy:{value:[i,s]},compass:{value:"south"},escapeHTML:{value:!0}}});e.namespace("U1.Widget"),e.U1.Widget.Tooltip=o},"@VERSION@",{requires:["event-mouseenter","widget","widget-position","widget-position-align","widget-stack","escape"]});
